---
title: ã€Podcastã€‘Grafana with Torkel Ã–degaard
tags:
  - Grafana
  - Internal tool
categories: Cloud Native
date: 2020-07-08 15:07:53
---

![](https://i.imgur.com/kase2RE.png)

# å‰è¨€

Grafana æ˜¯ä¸€å€‹`è¦–è¦ºåŒ–`ã€`å³æ™‚ç›£æ§`ä»¥åŠ plug-in system çš„å·¥å…·ï¼Œä¹‹å‰ä½¿ç”¨æ™‚ä¹Ÿå«æœ‰è¨±å¤š`å„€è¡¨æ¿(dashboard)`ä»¥åŠ`åœ–è¡¨`ä¾†å‘ˆç¾ Server ç‹€æ…‹ï¼Œä¸”ä»–å€‘é‚„å¾ˆé…·åœ°å°‡å®ƒ open source - [Grafana](https://github.com/grafana/grafana)ï¼Œä½¿ç”¨ React JS æ‰“é€ çš„å¯å®¹ä¸‹å¤§é‡è³‡æ–™çš„ç•«é¢ï¼ŒGrafana é™¤äº†æ”¯æ´å¤šå¹³å°å¤–ä¹Ÿæ”¯æ´ Dockerï¼Œæ¥ä¸‹ä¾†å°±ä¾†çœ‹ä¸€ä¸‹æˆ‘è½é€™é›†çš„å¿ƒå¾—å§ï¼

- [Podcast é€£çµ](https://overcast.fm/+E6UCVIbFo)
- [é€å­—ç¨¿](https://softwareengineeringdaily.com/wp-content/uploads/2020/06/SED1088-Grafana.pdf)
<!-- more -->

# Question

é€™é›†é‚€è«‹åˆ°çš„æ˜¯ Grafana Lab çš„ Torkel Ã–degaard ä¾†è«‡è«‡é—œæ–¼ open source ä»¥åŠå‰µç«‹å…¬å¸ç¨®ç¨®çš„å¿ƒè·¯æ­·ç¨‹ï¼Œå¾ä¸­å°±ç°¡å–®æ•´ç†å¹¾å€‹åœ¨è½çš„éç¨‹ä¸­æˆ‘è¼ƒæ„Ÿèˆˆè¶£çš„å•é¡Œ ğŸ™‚

## 1. When you first created Grafana, what was the state of the art for monitoring and visualization products?

ç°¡å–®çš„ä»‹ç´¹ Graphite é€™å€‹ [RRDtool](https://zh.wikipedia.org/wiki/RRDtool) ä»¥åŠ [statsd](https://github.com/statsd/statsd) æœ‰ç›¸ç•¶å¹´ç´€çš„å·¥å…·å¾Œï¼Œè¦ºå¾— Graphite æœ‰é»é›£ä½¿ç”¨å»ä¹Ÿéœ€è¦ statsd çš„åŠŸèƒ½ï¼Œå› æ­¤è¸ä¸Šè“‹ Grafana çš„è·¯ï¼Œä¹Ÿå¸Œæœ›å‡ºç¾åœ¨ TV ç‰†ä¸Š ğŸ˜†

> å¿ƒå¾—: å¤§å¤šçš„ open sourceã€å¥—ä»¶ã€å·¥å…·åŸºæœ¬ä¸Šéƒ½æ˜¯ç•¶å‰ç’°å¢ƒä¸‹çš„å·¥å…·ç„¡æ³•æ»¿è¶³è‡ªå·±å› æ­¤æ‰“é€ ä¸€å€‹å·¥å…·ï¼Œä¸”å‰›å¥½åˆèˆ‡å¸‚å ´ä¸Šçš„éœ€æ±‚å·®ä¸å¤šï¼Œä¸åƒ…æ˜Ÿæ˜Ÿæ•¸å¤§å¢ï¼Œä¹Ÿå› æ­¤å‰µé€ æ©Ÿæœƒè®“è‡ªå·±çš„å°ˆæ¡ˆå¯ä»¥æˆç‚ºä¸€å®¶å…¬å¸ï¼Œå¯¦åœ¨æ˜¯å¤§å®¶çš„æ¨™ç«¿å•Šã€‚

![](https://i.imgur.com/yBLiLrn.png)

### Graphite å•é¡Œ

ä¾†è³“æåˆ°å®ƒçš„ç•«é¢æ˜¯ä½¿ç”¨ render PNGsï¼Œåœ¨ç¾åœ¨çš„å‰ç«¯ä¸­çµ•å°ä¸æ˜¯ä¸€å€‹å¥½çš„æ–¹æ¡ˆï¼Œæˆ‘èªç‚ºå› ç‚º Grafana æ˜¯ä½¿ç”¨ Reactï¼Œå› æ­¤åœ¨è§£æ±º render å•é¡Œä¸Šæ‡‰è©²æ˜¯é§•è¼•å°±ç†Ÿ(ä½¿ç”¨ hook API - [åƒè€ƒ](https://medium.com/@z3388638/react-hooks-%E6%96%B0%E6%89%8B%E7%AD%86%E8%A8%98-8c9f1cccd142))ã€‚

> ä¸‰å¤§æ¡†æ¶éƒ½æœƒæœ‰ hook API çš„é€™ç¨®æ©Ÿåˆ¶å–”ï¼

åƒæ˜¯ [InfluxDB](https://www.influxdata.com/) ä»¥åŠ Prometheus é€™é¡çš„`æ™‚åºå‹è³‡æ–™åº«`éƒ½æœ‰æ”¹é€² Graphite ä¸Šæ“æœ‰çš„å•é¡Œã€‚

å› æ­¤å†è€…äº›å•é¡Œä¸‹ï¼ŒGrafana æƒ³è¦åšå‡ºä¸€å€‹å¯ä»¥æ”¶ä¾†è‡ªå„åœ°çš„ metrics ä»¥åŠ alertï¼Œé™¤äº†åŸºæœ¬çš„å¯è¦–åŒ–ä¹‹å¤–ï¼Œæƒ³è¦åšå‡ºèˆ‡é€™äº›è³‡æ–™åº«æ›´ä¸ä¸€æ¨£çš„åœ°æ–¹ã€‚

## 2. Streaming å•é¡Œ

åƒæ˜¯åœ¨ Grafana é€™é¡å·¥å…·ä¾†èªªï¼Œæ¯ä¸€å€‹åœ–è¡¨ä¸­åŸºæœ¬ä¸Šéƒ½æ˜¯å–®æ¬¡é€ Query å»æ‰“ Serverï¼Œå› æ­¤åœ¨ Streaming ä¸Šå¦‚ä½•åšå¿«å–ã€è³‡æ–™ä¾†æº...å„ç¨®è­°é¡Œï¼Œä½†å¦‚ä½•è™•ç†é€™ç¨®å·¨é‡è³‡æ–™ç›®å‰é‚„æ²’æœ‰æƒ³åˆ°ä¸€å€‹æœ€ä½³æ–¹æ¡ˆå»è§£æ±ºã€‚

> å¿ƒå¾—: åœ¨çœ‹å„ç¨®å°ˆæ¡ˆæ™‚ï¼Œä¸å…ä¿—çš„æœƒæœ‰å„ç¨® issue è·³å‡ºä¾†å¸Œæœ›å¯ä»¥åšä»€éº¼ï¼Œåªæ˜¯ç¸±è§€å°ˆæ¡ˆç™¼å±•èˆ‡å¯ç”¨æ€§ä¹‹é¡çš„äº‹æƒ…éƒ½éœ€è¦è€ƒæ…®é€²å»ï¼Œå› æ­¤è«¸å¦‚ cache é€™é¡çš„å•é¡Œå…¶å¯¦ä¹Ÿæ˜¯è¦æ›´å…¨é¢çš„è€ƒé‡ä¸‹æ‰èƒ½åšå‡ºä¸€å€‹æ›´å¥½çš„è§£æ±ºæ–¹æ¡ˆã€‚

## 3. Use language

åœ¨å…­å¹´å‰é–‹å§‹ä»–å€‘æ˜¯ä½¿ç”¨ Angular 2 ä¾†é–‹ç™¼ï¼Œéš¨è‘—æ™‚é–“æ¨ç§»å‡ºç¾äº† React ä¹Ÿå°‡å°ˆæ¡ˆç§»åˆ° React ä¸Š(å¯èƒ½ Angular ä¸€ç›´æ”¹ç‰ˆ?)ï¼Œä¹Ÿå› ç‚ºæœ‰å‰é¢æåˆ°çš„ `Hook API` ä¸Š

æ¢è¨äº†è¨±å¤šèˆ‡å‰ç«¯ç›¸é—œçš„è­°é¡Œï¼ŒåŒ…æ‹¬ `Hook API`ã€`UI components`ã€`data log search`ã€éå¾€è³‡æ–™æ“ä½œæ™‚éƒ½éœ€è¦å¯«è¨±å¤š callback ä¾†è™•ç†ï¼Œåœ¨é€™é‚Šå…¶å¯¦è½å¾—å‡ºä¾†ç¾ä»£æ¡†æ¶ç‚ºé–‹ç™¼è€…å€‘å¸¶ä¾†çš„æ¥µå¤§ä¾¿åˆ©æ€§ï¼Œä¸¦ä¸” Grafana ä¹Ÿæ˜¯å…¨ TypeScriptï¼Œæœ‰æ•ˆçš„å®šç¾©`å‹åˆ¥`èˆ‡`Interface`ï¼Œè®“åœ˜éšŠæˆå“¡å¯ä»¥æ›´å¿«é€Ÿåœ°äº†è§£ç¨‹å¼é‚è¼¯ã€‚

> æˆ‘çš„ç¶“é©—å°±æ˜¯å¾ä½¿ç”¨ jQuery æ“ä½œ DOM åˆ°ä½¿ç”¨ Vue Hook componentsï¼Œç¾ä»£ä¸‰å¤§æ¡†æ¶ä¸åƒ…è®“å¯«æ³•ä¸Šå¯ä»¥æ›´ç°¡æ½”ï¼Œä¹Ÿé™ä½æ•ˆèƒ½çš„å•é¡Œã€‚

## 4. èˆ‡å…¶ä»–å·¥å…·ä¸ä¸€æ¨£

é€™é‚Šæåˆ° Grafana ä¸æœƒå„²å­˜ä»»ä½•çš„ dataï¼Œåªæœƒå­˜ä¸€äº›äº‹ä»¶(è­¦å ±ä¹‹é¡çš„)ï¼Œä¸”å¯ä»¥åœ¨åœ–è¡¨ä¸Šä¸‹è¨»è§£ï¼Œå› ç‚ºå®ƒåªæ˜¯ä½¿ç”¨ Hook çš„æ©Ÿåˆ¶åšå¾ˆç´”ç²¹çš„äº‹æƒ…ï¼Œä¸æœƒæœ‰è³‡æ–™ç›œç«Šä¸Šçš„ç–‘æ…®ã€‚

## 5. å®‰è£å•é¡Œ

Grafana å®‰è£æ™‚æœ€å°å¯ä»¥ä½¿ç”¨åˆ° 100~200 mb çš„ RAM ä¸¦ä¸”æ­é… SQLiteï¼Œä¹Ÿå› ç‚ºä»–å€‘æ˜¯ Open Source Software(OSS)ï¼Œå› æ­¤ä¹Ÿå¯è‡ªç”±çš„ä½¿ç”¨ Docker ä¾†æ¶è¨­ï¼Œç•¶ç„¶è‹¥ä½¿ç”¨è€…å¤ªå¤šæ™‚é‚„æ˜¯éœ€è¦æœ‰æ•ˆè¦åŠƒä¾†å®¹ç´æµé‡ã€‚

## 6. Apache Arrow

é¡§åæ€ç¾©å°±æ˜¯ Apache çš„ä¸€å€‹é …ç›®ï¼Œå®ƒæ˜¯ä½¿ç”¨äºŒé€²åˆ¶æª”æ¡ˆçµæ§‹å»è™•ç†ä¸€äº›é€²è¡Œä¸­éåºåˆ—åŒ–çš„ä»»å‹™ï¼Œé™ä½åºåˆ—åŒ–æ‰€ç”¢ç”Ÿçš„æ¶ˆè€—ï¼Œä¸»è¦æä¾›è·¨å¹³å°æ‡‰ç”¨ä¾†åŠ å¿«å¤§æ•¸æ“šåˆ†æé …ç›®çš„é‹è¡Œé€Ÿåº¦ã€‚

> å¿ƒå¾—: é›–ç„¶æ²’åšéå¤§æ•¸æ“šï¼Œä½†çœ‹èµ·ä¾†åƒæ˜¯åœ¨è§£æ±ºå¹³è¡ŒåŒ–è™•ç†æ™‚çš„ä¸€äº›å…§éƒ¨è³‡æºå•é¡Œï¼Œæœ‰æ©Ÿæœƒä¾†å¥½å¥½ç ”ç©¶ä¸€ä¸‹ã€‚

æƒ³æ·±å…¥äº†è§£çš„è©±åƒè€ƒ:

- [å®˜ç¶²](https://arrow.apache.org/)
- [åƒè€ƒ 1](https://kknews.cc/zh-tw/tech/225x3kr.html)
- [åƒè€ƒ 2](https://www.infoq.cn/article/apache-arrow)

# çµè«–

æ¯æ¬¡è½é€™äº›ç¯€ç›®éƒ½è®“æˆ‘èªè­˜åˆ°è¨±å¤šæ–°çš„æ±è¥¿ï¼Œä¸”ä¸»æŒäººä¹Ÿé“å‡ºé–‹ç™¼è€…å€‘æ™®éæœƒæƒ³çŸ¥é“çš„å•é¡Œï¼Œç¶“ç‡Ÿé–‹æºå°ˆæ¡ˆè¦é¡§æ…®åˆ°çš„éƒ¨åˆ†ä¹Ÿèˆ‡ä¸€èˆ¬å…¬å¸ä¸ä¸€æ¨£ï¼Œ è®“æˆ‘æ”¶ç©«æ»¿æ»¿ï¼ŒåŒæ™‚è—‰ç”± onboard å‰çš„æ™‚é–“åŸ¹é¤Šè‹±è½çš„èƒ½åŠ›ä¹Ÿçœ‹é€å­—ç¨¿å­¸ç¿’å°ç§‘æŠ€è‹±æ–‡çš„æ•éŠ³åº¦ã€‚
