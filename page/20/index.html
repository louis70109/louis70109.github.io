<!DOCTYPE html>
<html lang="zh-tw">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.1">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PCZH6S3');</script>
<!-- End Google Tag Manager -->
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"nijialin.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":true,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"SY0XRJ8TKG","apiKey":"3598514b8d34a9c4d1fa895de761cfa2","indexName":"nijia_factor","hits":{"per_page":10},"labels":{"input_placeholder":"搜尋文章 & 內容","hits_empty":"找不到您輸入的關鍵字: ${query}","hits_stats":"找到了 ${hits} 筆結果，花了 ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="You are what you do.">
<meta property="og:type" content="website">
<meta property="og:title" content="忍者工坊">
<meta property="og:url" content="https://nijialin.com/page/20/index.html">
<meta property="og:site_name" content="忍者工坊">
<meta property="og:description" content="You are what you do.">
<meta property="og:locale" content="zh_TW">
<meta property="article:author" content="NiJia Lin">
<meta property="article:tag" content="LINE, python, LINE Bot, nijialin, nijia, javascript, chatbot">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://nijialin.com/page/20/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-tw'
  };
</script>

  <title>忍者工坊</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FYYPR3Z2K3"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FYYPR3Z2K3');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="忍者工坊" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">忍者工坊</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>關於</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="algolia-results">
  <div id="algolia-stats"></div>
  <div id="algolia-hits"></div>
  <div id="algolia-pagination" class="algolia-pagination"></div>
</div>

      
    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/louis70109" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/20/%E9%90%B5%E4%BA%BA%E8%B3%BD-%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/20/%E9%90%B5%E4%BA%BA%E8%B3%BD-%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8/" class="post-title-link" itemprop="url">鐵人賽-文章列表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-20 14:09:44" itemprop="dateCreated datePublished" datetime="2019-10-20T14:09:44+00:00">2019-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:51" itemprop="dateModified" datetime="2023-03-22T06:17:51+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="https://i.imgur.com/abW5lFB.jpg"></p>
<p>大家好，我是 NiJia</p>
<p>以下是我最近參加 IT 邦幫忙 30 天鐵人賽的<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/users/20111481/ironman/2475">文章列表</a>，主要是紀錄從我進入新公司後學到的<code>Serverless</code>，並透過結合 <code>LINE API</code> 實現在 <code>AWS</code> 上，歡迎大家參考取用 😃</p>
<hr>
<ul>
<li><a href="https://nijialin.com/2019/09/16/Day1-serverless-%E4%BB%8B%E7%B4%B9/">Day1 - serverless 介紹</a></li>
<li><a href="https://nijialin.com/2019/09/17/Day2-%E5%AE%89%E8%A3%9D%E4%B8%A6%E4%BD%BF%E7%94%A8%20wsgi%20&%20flask%20%E5%BB%BA%E7%AB%8B%E7%AC%AC%E4%B8%80%E5%80%8B%20Serverless%20%E7%9A%84%E5%B0%88%E6%A1%88/">Day2 - 安裝並使用 wsgi &amp; flask 建立第一個 Serverless 的專案</a></li>
<li><a href="https://nijialin.com/2019/09/18/Day3-LINE-Notify-%E4%BB%8B%E7%B4%B9/">Day3 - LINE Notify 介紹</a></li>
<li><a href="https://nijialin.com/2019/09/19/Day4-%E8%AA%8D%E8%AD%98%E8%88%87%E4%BD%BF%E7%94%A8-S3-%E5%AE%B9%E5%99%A8/">Day4 - 認識與使用 S3 容器</a>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2019/10/20/%E9%90%B5%E4%BA%BA%E8%B3%BD-%E6%96%87%E7%AB%A0%E5%88%97%E8%A1%A8/#more" rel="contents">
                閱讀全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/16/Docker-Mysql-PHPMyadmin-%E6%98%A0%E5%B0%84-%E9%80%A3%E6%8E%A5%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/16/Docker-Mysql-PHPMyadmin-%E6%98%A0%E5%B0%84-%E9%80%A3%E6%8E%A5%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">[Docker] Mysql & PHPMyadmin 映射 & 連接方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-16 14:06:49" itemprop="dateCreated datePublished" datetime="2019-10-16T14:06:49+00:00">2019-10-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>詳細文件<a target="_blank" rel="noopener" href="https://hub.docker.com/_/mysql">參考</a></p>
<p>docker 抓 mysql 最新的版本</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:tag</span><br></pre></td></tr></table></figure>

<p>若只是要建立普通容器用以下指令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 -e MYSQL_USER=<span class="string">&quot;myname&quot;</span> -e MYSQL_PASSWORD=<span class="string">&quot;mypasswd&quot;</span> -e MYSQL_ROOT_PASSWORD=<span class="string">&quot;root_pwd&quot;</span> --name mysqltest1 mysql:5.7 --character-set-server=utf8 --collation-server=utf8_general_ci</span><br></pre></td></tr></table></figure>

<p>由於會有備份的問題，所以要先建立資料夾們</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/docker</span><br><span class="line">mkdir ~/docker/mysql</span><br><span class="line">mkdir ~/docker/mysql/conf</span><br><span class="line">mkdir ~/docker/mysql/data</span><br></pre></td></tr></table></figure>

<p>新增 my.cnf 配置文件</p>
<p>vim ~&#x2F;docker&#x2F;mysql&#x2F;conf&#x2F;my.cnf</p>
<p><code>my.cnf</code> 加入如下内容：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">  user=mysql</span><br><span class="line">  character-set-server=utf8</span><br><span class="line">  default_authentication_plugin=mysql_native_password</span><br><span class="line">[client]</span><br><span class="line">  default-character-set=utf8</span><br><span class="line">[mysql]</span><br><span class="line">  default-character-set=utf8</span><br></pre></td></tr></table></figure>

<p>將 &#x2F;docker 這個資料夾映射到容器內的 &#x2F;etcmysql&#x2F;my.cnf</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --privileged=<span class="literal">true</span> -v ~/docker/mysql/conf/my.cnf:/etc/mysql/my.cnf -v ~/docker/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysqltest2 mysql:5.7</span><br></pre></td></tr></table></figure>

<ul>
<li>–privileged&#x3D;true：容器内的 root 永有真正 root 权限，否則容器内 root 只是外部普通用戶權限</li>
<li>-v ~&#x2F;docker&#x2F;mysql&#x2F;conf&#x2F;my.cnf:&#x2F;etc&#x2F;my.cnf：映射 config 資料夾</li>
<li>-v ~&#x2F;docker&#x2F;mysql&#x2F;data:&#x2F;var&#x2F;lib&#x2F;mysql：映射 data 資料夾 (table 都在這)</li>
</ul>
<p>如此一來就可以儲存 &#x2F;docker 這個資料夾達到備份的功能</p>
<h2 id="PHPMyadmin"><a href="#PHPMyadmin" class="headerlink" title="PHPMyadmin"></a>PHPMyadmin</h2><p>將 myadmin 連接 mysql 的容器指令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name myadmin -d --link mysql_db_server:db -p 9100:80 phpmyadmin/phpmyadmin</span><br></pre></td></tr></table></figure>

<p>mysql_db_server &#x3D; mysql container id</p>
<p>在瀏覽器上輸入 localhost:9100 就可以看到 phpmyadmin 囉！</p>
<h2 id="Docker-查詢容器-IP"><a href="#Docker-查詢容器-IP" class="headerlink" title="Docker 查詢容器 IP"></a>Docker 查詢容器 IP</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect -f <span class="string">&#x27;&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;&#x27;</span> container_name_or_id</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/14/Day30-%E8%80%81%E6%98%AF%E5%9C%A8%E5%90%B9-Serverless%EF%BC%8C%E4%BB%96%E7%9C%9F%E7%9A%84%E6%9C%89%E9%82%A3%E9%BA%BC%E5%A5%BD%EF%BC%9F/" class="post-title-link" itemprop="url">Day30 - 老是在吹 Serverless，他真的有那麼好？</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-14 13:09:01" itemprop="dateCreated datePublished" datetime="2019-10-14T13:09:01+00:00">2019-10-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Cold-start"><a href="#Cold-start" class="headerlink" title="Cold start"></a>Cold start</h2><p>其實個家園端平台多少都會有這問題，畢竟大家都是靠流量賺錢，自然會需要個方法限制使用者，不然免費爽爽用他們也不是做慈善的 🤣，像我最常用的 <code>Heroku</code>，只要 30 分鐘沒有使用他就會進入睡眠時間(<a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/free-dyno-hours">參考</a>)，叫醒的時間需要 10~15 秒，不過對於我這個免費宅來說測試夠用了 🤣</p>
<p><code>AWS</code>以我實際測試起來大概 2 秒左右，回應時間看起來不會太差，其實<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10213431">第一天</a>就有提到這部分，需要的話可以參考。</p>
<p>若是需要它隨時都在都活著的話就要搭配 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10226742">warm-up</a>，抑或是搭配 crontab 去設定特定時間執行 warm-up。</p>
<h2 id="Function-as-a-Service"><a href="#Function-as-a-Service" class="headerlink" title="Function as a Service"></a>Function as a Service</h2><p>在快速成長的前、中期是很適合這個服務的， 畢竟開發者只要將 <code>serverless.yml</code> 基本設定完之後就可以先好好開發，等到中期之後把設定檔稍微整理一下又是一尾活龍了，且平台大多都擁有 <a target="_blank" rel="noopener" href="https://aws.amazon.com/tw/autoscaling/">auto-scaling</a> 的功能，在服務快扛不住流量的時候只要錢拿出來平台就幫你解決。</p>
<p>只是說當流量越來越大之後相對錢也會越付越多，或許當流量 &gt; 10K 之後代表你的服務應該也有不少人使用了，自己架主機應該不會是什麼難事(?)</p>
<blockquote>
<p>幫忙推廣一下 Backend 大大的 <a target="_blank" rel="noopener" href="https://github.com/TritonHo/slides/blob/master/Taipei%202019-10%20talk/concurrency.pdf?fbclid=IwAR3R67wIt5fXPjG3hZNHaVw3tuCVrpNJtIdecTTIiQz0dgT-bZwymIYLYiA">高流量心得雜談</a></p>
</blockquote>
<p>在 FaaS 架構下其實很適合 Chatbot 的服務，以概念來說實作時只需要一個路由**(Function)**即個完成，不需要額外太多的資源去處理 web server 的問題，像是這個系列的只要透過 <code>serverless</code> + <code>WSGI</code> 就可以馬上就可以進行本地測試，部署只要下 <code>sls deploy</code>，實在是超級快又輕鬆，不用像以前一樣還要去處理 Nginx 等等相關的問題 😁。</p>
<p>且 AWS、Google 在使用 python 跟 nodejs 上支援度很高，也不用怕找不到資源使用。</p>
<blockquote>
<p>使用 Node JS 的朋友可以參考 C.T Lin 大大的<a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/users/20103630/ironman/2798">文章</a>，他們家的 bottender 超猛的！</p>
</blockquote>
<h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><p>在 Log 這部分我覺得 AWS 有點不太好的地方就是他們的 Cloud Watch 應該是獨立服務，當我的 Lambda 輸出紀錄時大概要過 10 秒才會印出來，不像以前自己架主機時只要進 server 就可以馬上切到目錄看紀錄抓蟲，在使用這雲端服務可能在抓蟲有一半的時間都在等 log 出來，有時候急的時候還真的會被氣死 😭。</p>
<h2 id="SNS"><a href="#SNS" class="headerlink" title="SNS"></a>SNS</h2><p>像是我前一陣子發的<a target="_blank" rel="noopener" href="https://medium.com/@nijia.lin/use-serverless-corn-to-execute-sns-getendpointattributes-returns-old-data-after-e7df7c09b45b">一篇文章</a>，SNS 被觸發事件之後回來的東西是舊的，那時候看到錯誤訊息真的是心很涼，就得用一個 Lambda 排程一直去抓 DB 的 updated_at 欄位有沒有變更時間而去更新狀態，這樣情況就會多浪費一個 Function 去處理這樣的事件，不得不說專門來支援 AWS 服務的 boto3 套件(python)在某些時候做的事不是那麼完善，得使用旁門做到的方法去完成這件事，讓整個開發體驗不是那麼好，若他們可以把一些 error handle 弄更好那就完美了。</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><blockquote>
<p><del>其實還有好多服務沒有玩到</del></p>
</blockquote>
<p>但其實使用 AWS 來實作 Serverless 的服務也是這一陣子加入新公司所學到的新技能，過程中總是會用舊的開發思維去想，但常常都因為這樣落坑 😓，但也因此讓我更了解像 AWS 這類的雲服務他們是如何開發每個服務並如何串接，同時也研究了 Serverless 相關的 plugins，看他們是如何支援雲平台讓開發者在開發時可以更像平常時在開發 web，也因為這樣我去貢獻了 example 到了 Serverless 的範例專案上面(<a target="_blank" rel="noopener" href="https://github.com/serverless/examples/pulls?q=is:pr+author:louis70109+is:closed">參考</a>)，慶祝完成人生第一場鐵三十，跟自己的競賽也告一段落，發現趕著寫文章品質真的會差很多，看來是時候該整理一下，謝謝您的收看 &lt;(_ _)&gt;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/13/Day29-LINE-API-%E7%9A%84%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97/" class="post-title-link" itemprop="url">Day29 - LINE API 的使用心得</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-13 13:08:19" itemprop="dateCreated datePublished" datetime="2019-10-13T13:08:19+00:00">2019-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>Imagemap</p>
<ul>
<li>這邊以微股力為範例，這隻機器人會再回應的時候輸出一張圖片讓使用者看到股票的曲線圖，然後圖片下方做三個類似按鈕的圖片在上面，再藉由設定觸發訊息在座標上，當使用者按到的時候就很像再按按鈕，更多使用方法或是 UX 上的問題可以參考 <a target="_blank" rel="noopener" href="https://www.facebook.com/uxerlab/">UX 三刀流</a>。<br><img src="https://i.imgur.com/A0yDTJm.png"></li>
</ul>
</li>
<li><p>Richmenu</p>
<ul>
<li>Richmenu 等於把 imagemap 活生生的塞在下面，讓使用者再進聊天室時就能馬上看到圖片並按下對應的區塊而不用再輸入指令把 Imagemap 叫出來，如此就少了個步驟了，並讓開發者可以有更多的發揮空間呢！</li>
</ul>
</li>
<li><p>設計工具</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.line.biz/en/services/bot-designer/">Bot designer</a><br>這個工具是桌面版，可以直接抓下來在本地端直接設計，<br><img src="https://i.imgur.com/dDMSCXu.png"><br><img src="https://i.imgur.com/c2pYpFx.png"></li>
<li><a target="_blank" rel="noopener" href="https://developers.line.biz/console/fx-beta/">FLEX MESSAGE SIMULATOR [β]</a><br>它有提供<a target="_blank" rel="noopener" href="https://developers.line.biz/console/fx-beta/">線上工具</a>讓大家可以在線上直接測試樣板或是直接刻自己想要的樣板。<ul>
<li>使用心得：因為寫 Rails 基本上就是在寫全端了，難免會碰到 CSS，身為一個後端工程師排版，一定要用 flex 這個超級毒品(\吸起來&#x2F;)，接著過了一段時間後接觸到 LINE bot，且 flex message 也是基於 <a target="_blank" rel="noopener" href="https://www.w3.org/TR/css-flexbox-1/">Flexbox</a> 的規格去實作的，所以很多排版上觀念都很像，也就不太會有障礙了 😁。<br>且在排版上還有表格告知你什麼 component 要在什麼區塊內才能用，多佛心啊～<br><img src="https://i.imgur.com/Fowpoyb.png"><br><img src="https://i.imgur.com/zELPSA0.png"></li>
</ul>
</li>
</ul>
</li>
<li><p>API 文件</p>
<ul>
<li>在最近幾個月的時候 LINE 的文件有改版，讓某些 API 可以在線上就能測了，看起來是滿讚的，若在逛文件時碰巧想測試這些功能的話可以直接把相關參數放進去，在某些時候也是滿方便的。<br><img src="https://i.imgur.com/CuFdmcH.png"></li>
</ul>
</li>
<li><p>LIFF (LINE Front-end Framework)</p>
<ul>
<li>個人覺得他讓 Bot 的發揮功力又更上一層樓了，以前很多開發者都會覺得在與機器人對談中會有很多東西是不好做的，像是購物車的流程，若使用者在流程中按了上面的按鈕的話可能會發生無法預期的錯誤，且得用其他的服務去儲存操作狀態，在開發上就很麻煩，那 LIFF 就讓這個流程可以簡單許多，且能透過 SDK 在網頁上取得使用者的資訊，讓網站再被使用的同時還可以確認身份。</li>
</ul>
</li>
<li><p>推播 500 則</p>
<ul>
<li>在今年 OAuth 2.0 釋出當中推播則數也跟改動了，改成 500 則後其實看到不少的使用者在跳腳怎麼改成這樣，或是另類的變貴收費，只能說 LINE 也是要找方法收點費用呀，不然很多功能爽爽用他們也沒有地方去收費，這部分因為我也是少用，推播功能就都交給 <code>LINE Notify</code> 嚕！</li>
</ul>
</li>
<li><p>客服與機器人的切換</p>
<ul>
<li>參考 C.T Lin 大大的文章 <a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10220717">Day10</a>，簡單來說 Messager 可以在機器人處理不來的時候將訊息轉丟給設定的那位管理員，讓他來回覆訊息，但 LINE 在機器人上只能透過網頁去切換機器人狀態，抑或是自己設計流程讓機器人在無法處理才通知管理員，這樣的話管理員很容易錯過黃金的第一時間，可能也會因此造成使用者的不便。</li>
</ul>
</li>
<li><p>個人的 mur mur 🤣</p>
<ul>
<li>文件實在是太瀑布式了，雖然現在都懂的如何搜尋到相對應的功能，但若一般想開發的使用者在看到這個文件時瘋狂往下滑，結果發現還沒有滑到或是滑過頭，倒是找資料時氣得要死 😓，所以若是文件能夠分個頁籤什麼就更好了～</li>
</ul>
</li>
</ul>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>當然整體來說還是很喜歡使用 LINE 這個平台(絕對不是因為熊大 🐻)，東西也不會像一開始在開發時什麼都找不太到，並且功能一直 release，讓服務可以透過不同的整合方法去達成目標，接下來 LINE 應該還會再繼續釋出不同的東西，就請大家拭目以待，或者…來參加<a target="_blank" rel="noopener" href="https://www.facebook.com/groups/chatbot.tw"> chatbot 小聚</a>直接問問 LINE 的傳教士如何呢 😁</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/12/Day28-%E7%94%A8-S3-%E5%B9%AB%E5%BF%99%E8%BD%89%E5%9D%80%E5%88%B0%E5%8E%9F%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8B%99%E4%B8%8A/" class="post-title-link" itemprop="url">Day28 - 用 S3 幫忙轉址到原有的服務上</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-12 13:07:18" itemprop="dateCreated datePublished" datetime="2019-10-12T13:07:18+00:00">2019-10-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在之前的文章都有將 <code>Notify</code>、<code>LINE Login</code>所需要的靜態頁面放在 S3 上面，讓其他使用者去點，雖然把前端放在程式裡面用 render template 比較好，可是在求快的情況下我把靜態頁面寫完就扔上去了(被拖走)，其實也可以透過這個方法去幫忙轉址，不過接下來我會用我的臉書做個範例提供參考～</p>
<h2 id="實作"><a href="#實作" class="headerlink" title="實作"></a>實作</h2><p>照著之前的範例來建立一個名為 <code>facebook.nijialin.com</code> 來做 S3 轉址的範例<br><img src="https://i.imgur.com/BJyONqF.png"><br>建立完之後因為我們需要把網址公開給其他使用者點選，在第三個分頁中先把第一個選項的 <code>Block all public access</code> 更換成 off 狀態<br><img src="https://i.imgur.com/FAoiCbt.png"><br>到第二個按鈕選項選擇 <code>Public access</code>，暴力一點把所有選項都打開 🤣<br><img src="https://i.imgur.com/WhCoHl4.png"><br>前面都已經把權限開完，選擇<code>Static Website hosting</code>這個選項，這個是 S3 提供來讓他有另一種功能，不過我是覺得這功能在這邊有點奇怪 XD<br><img src="https://i.imgur.com/yPv6nET.png"></p>
<hr>
<p>接著就來到 <code>Route 53</code>，點選左欄的 <code>Hosted Zone</code><br><img src="https://i.imgur.com/k1T8wIT.png"><br>點選上面藍色的按鈕，右邊會出現輸入的地方讓你填<br><img src="https://i.imgur.com/szIVARy.png"><br>這邊我會輸入跟 S3 bucket 的名字一樣，然後 <code>Alias</code> 選擇 Yes，下面輸入框點下去會看到自己剛剛輸入的 S3 website endpoints<br><img src="https://i.imgur.com/PVlFHJZ.png"><br>建立完之後就可以在瀏覽器上輸入網址，他就會導去你預設的網站囉！向我這邊就是拿我的 facebook 來做示範。</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>我透過這個方法幫我把 medium 的部落格網址重新導向，因為我想之後若是有獨立建立部落格的話網址會是一樣的，當有點粉絲的話至少他們認得的網址會是一樣的 😁。</p>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a target="_blank" rel="noopener" href="https://www.kilait.com/2015/09/08/route-53-%E9%9D%9C%E6%85%8B%E8%BD%89%E5%9D%80/">Route 53+靜態網址</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/11/Day27-Use-CDN-2-CloudFront/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/11/Day27-Use-CDN-2-CloudFront/" class="post-title-link" itemprop="url">Day27 - Use CDN (2) - CloudFront</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-11 13:06:26" itemprop="dateCreated datePublished" datetime="2019-10-11T13:06:26+00:00">2019-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>不管是建立虛擬機(EC2)，又或是像我們建立 Serverless 的服務(Lambda)，總會挑選離自己家近的節點(東京)，又或者可能因為價錢的關係選擇相對便宜的地點，但不管機器在哪，對於在台灣的我們來說都是一樣跨海啊！但好險台灣擁有 CloudFront 的節點，透過快取讓使用者可以更快的取得服務器上的資源，可能第一次都會比較慢，但只要讓 CloudFront 看過一次就會幫忙快取起來，下次使用者在用的時候就不會那麼慢囉！</p>
<h2 id="建立-CDN"><a href="#建立-CDN" class="headerlink" title="建立 CDN"></a>建立 CDN</h2><p>首先我們先進去 CloudFront 的頁面，按下左欄的<code>Distribution</code>後並 <code>Create</code>的藍色按鈕<br><img src="https://i.imgur.com/WQ5o8rl.png"><br>因為我們是做 Web API 相關的，這邊當然就是選 Web 囉！<br><img src="https://i.imgur.com/htzGaGA.png"><br>到了這邊，AWS 很有心的在這些輸入框大多都有下拉式選單，這邊就選建立完的那個專案名稱<br><img src="https://i.imgur.com/ntJu1Cm.jpg"><br>選完之後下面三個就照著這樣點選，Comment 會幫你自動填入<br><img src="https://i.imgur.com/XkbNkfz.png"><br>CNAMEs 的部分這邊我填入我在 <code>serverless.yml</code>裡 create_domain 所設定的 <code>line.nijia.lin</code> 字串，SSL 就選擇上一篇所建立的 Certificate<br><img src="https://i.imgur.com/SdnaZhe.png"><br>建立完成之後就會看到他 <code>In progress</code>，CloudFront 就開始撒點告訴其他節點有建立這個名為 <code>line.nijia.lin</code>，有看到他的時候記得幫他做個 Cache<br><img src="https://i.imgur.com/RibhSWw.png"><br>等個大概 15 分鐘後他就部署完成啦～<br><img src="https://i.imgur.com/kHYSETU.png"><br>點進來可以確認自己剛剛設定的資訊對不對，若有設定錯誤在按 Edit 來修正<br><img src="https://i.imgur.com/HdCn9ue.png"></p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>現在每個服務都很流行 CDN，若有在寫前端的朋友常常就會用到 jQuery、Bootstrap、Vue 等等可以再標頭檔就引入的 CDN 路徑，CDN 不僅加速我們平常在抓伺服器資料的速度，也便利了我們有時候需要寫一些簡單的靜態頁面時可以透過抓取 CDN 路徑來快速取得需要的資源，但是像是 AWS 他們都是收取流量費，用得很爽時別忘了看一下自己的帳單是不是在哀嚎 🤣</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/10/Day26-Use-CDN-1-%E5%BB%BA%E7%AB%8B-Certificate-%E8%88%87-Domain/" class="post-title-link" itemprop="url">Day26 - Use CDN (1) - 建立 Certificate 與 Domain</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-10 21:05:23" itemprop="dateCreated datePublished" datetime="2019-10-10T21:05:23+00:00">2019-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2024-02-13 06:28:44" itemprop="dateModified" datetime="2024-02-13T06:28:44+00:00">2024-02-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="簡介"><a href="#簡介" class="headerlink" title="簡介"></a>簡介</h2><p>繼上一篇 warm-up 機制之後來了解一下如何使用 AWS 的 CDN 服務 - cloudfont，CDN 顧名思義就是要讓使用者可以到最接近的主機上去拉到對應的資料，透過撒點的方式讓主機去挑選離自己近的服務據點，藉此加速服務。</p>
<p>像我之前部署在 ohio，想想光網路的時間 + Cold start 的時間就已經去了一大半，即便我們有熱開機，服務沒有 Timeout 我該慶幸了，既然如此就不得不認識一下 CDN 服務，而 AWS 的 CDN 服務就是 cloudfont 啦！</p>
<p>只是說原本的 domain 已經有 SSL 了，但是代理沒有這個東西，所以我們要 ban 出一個 Certificate，那在在建立 cloudfont 以前需要先到 Certificate Manager，接著會用圖片帶大家一步一步做</p>
<p><img src="https://i.imgur.com/vLLfKyr.png"></p>
<h2 id="開始之前"><a href="#開始之前" class="headerlink" title="開始之前"></a>開始之前</h2><p>我已經有先在 Route53 註冊了一個 <code>nijialin.com</code> 的 domain，<code>.com</code>大概 10 美金左右，若是有在其他地方註冊域名的話要找一下相關文章把它導進 Route53 哦！</p>
<h2 id="註冊-Certificate"><a href="#註冊-Certificate" class="headerlink" title="註冊 Certificate"></a>註冊 Certificate</h2><ul>
<li>先來到 Certificate Manager 頁面，按下左下角的這個</li>
</ul>
<p><img src="https://i.imgur.com/WVk2YFJ.png"></p>
<ul>
<li>接著就直接按右下角啦，但是要確定是不是 public</li>
</ul>
<p><img src="https://i.imgur.com/sNxd3LG.png"></p>
<ul>
<li>這裡輸入你在 route53 註冊的 domain，這邊我是輸入 *.nijialin.com</li>
</ul>
<p><img src="https://i.imgur.com/FXnknbj.png"></p>
<ul>
<li>到第四部之後就會看到申請的 SSL Pending</li>
</ul>
<p><img src="https://i.imgur.com/WlY5PCf.png"></p>
<ul>
<li>最後回首頁之後就會看到 SSL 簽證正在送簽中<br><img src="https://i.imgur.com/kRRtvJ5.png"></li>
</ul>
<p>最後就等他完成嚕！將將<br><img src="https://i.imgur.com/495PjEw.png"><br>接著我們到 API Gateway 找到左邊的 <code>Custom Domain Name</code>，我們要來建立屬於這個 API 的 Domain 了<br><img src="https://i.imgur.com/BzkvgUR.png"><br>按下藍色的按鈕之後，輸入<code>Domain name</code>以及選擇剛剛註冊的 Certificate 後按下 <code>Save</code><br><img src="https://i.imgur.com/xwBEC5O.png"><br>他就會開始初始化剛剛的設定，這邊大概需要等 15 分鐘左右<br><img src="https://i.imgur.com/dLMaXrx.png"><br>在此同時我們就去新增專案裡的套件 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/serverless-domain-manager">Domain-Manager</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install serverless-domain-manager --save-dev</span><br></pre></td></tr></table></figure>

<p>並且在<code>plugin</code>下加入套件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">serverless-domain-manager</span></span><br></pre></td></tr></table></figure>

<p>在<code>custom</code>底下加入</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">custom:</span></span><br><span class="line">  <span class="attr">domainName:</span></span><br><span class="line">    <span class="attr">default:</span></span><br><span class="line">      <span class="attr">domainName:</span> <span class="string">line.nijialin.com</span></span><br><span class="line">      <span class="attr">certificateName:</span> <span class="string">&quot;*.nijialin.com&quot;</span></span><br><span class="line">      <span class="attr">createRoute53Record:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">endpointType:</span> <span class="string">edge</span></span><br></pre></td></tr></table></figure>

<p>等待前面初始化成功之後部署這個專案<code>sls deploy</code>之後就會看到剛剛註冊的域名啟動囉！<br><img src="https://i.imgur.com/Pn2TyMD.png"></p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>在建立 Certificate 那邊倒沒什麼問題，畢竟需要一個 SSL，只是到了建立 domain 這邊遇到了很怪的問題，一般來說使用 serverless 框架來跑的話只要照的文件裡說的 <code>serverless create_domain</code>就會幫忙註冊，而且可以依照自己開發環境去自動設定，在公司的專案中這樣使用是沒問題的，在是在寫這篇文章時卻只能使用以上的方法來替代使用，雖然結果是一樣的，但是用起來實在是很不符合邏輯，google 也沒找到類似的問題，或許這個問題還要多實測幾次才夠…😭</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/10/welcome-line-api-expert/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/10/welcome-line-api-expert/" class="post-title-link" itemprop="url">Welcome to LINE API Expert and first thing — LINE Developer Day</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-10 09:26:16" itemprop="dateCreated datePublished" datetime="2019-10-10T09:26:16+00:00">2019-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:51" itemprop="dateModified" datetime="2023-03-22T06:17:51+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%97%A5%E8%A8%98/" itemprop="url" rel="index"><span itemprop="name">日記</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>人品爆發的下半年有幸被選為 LINE API Expert，謝謝過程中給我指點、意見還有每位來參加每個 chatbot TW 活動的朋友，你們支持讓我可以更努力去辦各種活動，社團裡歡迎大家踴躍提點子討論，抑或是來參加小聚跟大家互相交流，台北台中都有小聚哦！若有不清楚的地方歡迎詢問😃<br>Chatbot Developers Taiwan：<a target="_blank" rel="noopener" href="https://www.facebook.com/groups/chatbot.tw">https://www.facebook.com/groups/chatbot.tw</a></p>
<h1 id="迎新"><a href="#迎新" class="headerlink" title="迎新"></a>迎新</h1><p>在 welcome party 中身為 Rookie of LINE API Expert 一定是要被每一位大神輪流 “熱情關照” 一波🤣，想想之前在開發時還在看卡米狗 卡卡米 的 IT 30 鐵人賽、寫 golang 看著 Evan Lin 的部落格、看保哥 Will Huang 在議程中各種秀高速開發技能 … 等等的，沒有到偶像們就直接坐在旁邊，看著看著我就快不行了😝。跟大神們聊完覺得自己做的事還只是冰山一角，看著大家都那麼有影響力下還是這麼努力向前進，做為菜鳥的我當然不能就這樣滿足！繼續抱著大神們的腿前進。(喂！放開自己走啊！)<br><img src="https://i.imgur.com/bkefPAh.jpg"></p>
<h1 id="成為-LAE-後的第一場開發者日"><a href="#成為-LAE-後的第一場開發者日" class="headerlink" title="成為 LAE 後的第一場開發者日"></a>成為 LAE 後的第一場開發者日</h1><p>緊接著第一場大型活動就是參加 LINE 的年度大會 — LINE Developer Day，過往都只能看著前輩們分享文章在電腦前面乾過癮，看著大家可以在國際間跟各路的開發者交流，這一直是我很羨慕的事情之一。但是！現在終於有機會以 LAE 的身分出發啦(媽我在這)！聽說去年有 60 場各種主題的座談會，而今年 LINE 主要會以推廣 人工智慧 為主軸，並且搭配其他在 LINE 中重要的技術形成了這次的 developer day，也開始漸漸露出在新聞版面了，看起來想拓展的企圖心也越來越強了🚀<br>以下是其他 LAE 以及社群創始人 Clement Tang 在 2018 年參加 LINE Dev Day 的文章分享</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://medium.com/@wolkesau/2018-%E5%B9%B4%E5%BA%A6%E5%A4%A7%E6%88%B2-line-api-expert-%E4%B9%8B%E6%97%85-4a12a79a0c04">2018 年度大戲 LINE API expert 之旅</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@dlackty/%E5%BE%9E-line-developer-day-keynote-%E4%B8%80%E7%AA%BA-line%E7%94%9F%E6%85%8B%E7%B3%BB%E7%9A%84%E9%A1%98%E6%99%AF-ai-%E7%AF%87-f5be69e9c682">從 LINE Developer Day Keynote 一窺 LINE生態系的願景 — AI 篇</a></li>
<li><a target="_blank" rel="noopener" href="http://studyhost.blogspot.com/2018/11/line-developer-day-2018_24.html?source=post_page-----6c69fdfc991d----------------------">LINE Developer Day 2018 東京豐盛技術之旅(下)</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/@clementtang/line-developer-day-2018-%E6%B4%BB%E5%8B%95%E8%A6%8B%E8%81%9E%E8%88%87-keynote-%E7%B4%80%E9%8C%84-6469de55c3f8">LINE Developer Day 2018 - 活動見聞與 Keynote 紀錄</a></li>
</ul>
<p>2019 的 Dev Day 資訊出來囉，<br>活動時間： 2019&#x2F;11&#x2F;20、21, 10:00~21:00 (日本時間)<br>活動地點：東京台場日航大酒店Grand Nikko Tokyo Daiba （2–6–1 Daiba, Minato-ku, Tokyo）<br>活動入場費用：免費<br>參加方式：繳交報名表、預先報名</p>
<blockquote>
<p>活動則環繞在開發工程(Engineering)以及產品開發(Production)上</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.techbang.com/posts/73284-lines-first-expansion-will-be-held-on-november-20th-and-21st-for-two-day-line-developer-day-2019?source=post_page-----6c69fdfc991d----------------------">「LINE DEVELOPER DAY」開發者大會將於11&#x2F;20、21東京登場 | T客邦</a></p>
<blockquote>
<p>屆時我會分享文章出來，還請各位多多關注😀</p>
</blockquote>
<h1 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h1><p>說了這麼多，還不去申請一波 LINE API Expert？讓自己的努力有個機會被 LINE 看見：<br><a target="_blank" rel="noopener" href="https://www.line-community.me/contributors/request?source=post_page-----6c69fdfc991d----------------------">LINE developers community | Expert Request</a><br>或是你還不清楚要怎麼開始第一步，來小聚跟我們聊聊吧，社群的每位大大都很熱心跟各位分享，千萬別錯過這些機會哦！<br><a target="_blank" rel="noopener" href="https://chatbots.kktix.cc/events/chatb13ts?source=post_page-----6c69fdfc991d----------------------">Chatb13ts meetup 聊天機器人小聚 #13 @ 台北商業大學</a><br>▎活動型態 Chatbots meetup 社群台北、台中皆有一個月一次的定期聚會，致力於提供並討論聊天機器人的相關應用，每回小聚將安排講者主題分享、新知討論，環繞 Chatbot。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/09/Day25-Lambda-%E5%A5%BD%E5%83%8F%E6%9C%89%E6%99%82%E5%80%99%E4%B8%80%E9%96%8B%E5%A7%8B%E5%9B%9E%E6%87%89%E5%BE%88%E4%B9%85%EF%BC%9F%E7%94%A8-warm-up-%E4%BE%86%E7%86%B1%E6%A9%9F%E5%90%A7/" class="post-title-link" itemprop="url">Day25 - Lambda 好像有時候一開始回應很久？用 warm-up 來熱機吧</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-09 13:04:36" itemprop="dateCreated datePublished" datetime="2019-10-09T13:04:36+00:00">2019-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇會介紹 npm 套件庫裡的 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/serverless-plugin-warmup">Serverless-plugin-warmup</a>，裡面介紹了很多參數可以使用，以下會簡介如何引入它。</p>
<h2 id="實作"><a href="#實作" class="headerlink" title="實作"></a>實作</h2><p>透過<code>npm</code>來安裝套件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev serverless-plugin-warmup</span><br></pre></td></tr></table></figure>

<p>在<code>serverless.yml</code>的<code>plugin</code>加入套件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">plugins:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">serverless-plugin-warmup</span></span><br></pre></td></tr></table></figure>

<p>在<code>custom</code>加入<code>warm up</code>的設定參數</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">custom:</span></span><br><span class="line">  <span class="attr">warmup:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">cleanFolder:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">memorySize:</span> <span class="number">128</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&quot;LINE-warmup-pop&quot;</span></span><br><span class="line">    <span class="attr">events:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">schedule:</span> <span class="string">&quot;cron(0/5 0-12 ? * MON-FRI *)&quot;</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>

<p><code>.gitignore</code>加入以下兩個<code>_warmup/</code>以及<code>.requirements.zip</code>，他在部署前建立一個<code>_warp</code>的資料夾並放一個 Lambda 來打已建立的 api 以及 Lambda 們，部署後會建立<code>.requirements.zip</code>，所以這邊就加入這兩行來防止被 git 推上去。</p>
<blockquote>
<p>或許會有疑問不是<code>cleanFolder</code>設定 true 就可以，這邊我自己實測時在部署會因為 Size 過大而無法上傳，把這參數設定掉他才會乖乖的上傳成功，但這部分有待驗證。</p>
</blockquote>
<h2 id="加入-decorator"><a href="#加入-decorator" class="headerlink" title="加入 decorator"></a>加入 decorator</h2><p>這邊我在<code>lib/</code>下新增一個<code>decorator.py</code>，加入以下的 code</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"><span class="keyword">from</span> logging <span class="keyword">import</span> Logger</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lambda_warm_up</span>(<span class="params">func</span>):</span></span><br><span class="line"><span class="meta">    @wraps(<span class="params">func</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span>(<span class="params">*args, **kwargs</span>):</span></span><br><span class="line">        source = args[<span class="number">0</span>].get(<span class="string">&#x27;source&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (source == <span class="string">&#x27;serverless-plugin-warmup&#x27;</span>):</span><br><span class="line">            Logger.info(<span class="string">&#x27;WarmUp - Lambda is warm!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure>

<p>主要功能是透過 python decorator 的特性讓我們在 function 之前用個前綴符號就可以引用它，很像 po 文在 tag 別人一樣 🤣<br>warm-up 建立的 Lambda 會固定對其他的 Lambda 打<code>serverless-plugin-warmup</code>的字串，這邊就寫個判斷式判斷掉後直接 return</p>
<p>你以為這樣就結束了？還有 IAM role 的問題呢，詳細問題已不可考，想試看看的可以把 IAM 拔掉再部署一次，問題就會出現了，以下為設定檔：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">iamRoleStatements:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">Effect:</span> <span class="string">&quot;Allow&quot;</span></span><br><span class="line">    <span class="attr">Action:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;lambda:InvokeFunction&quot;</span></span><br><span class="line">    <span class="attr">Resource:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">Fn::Join:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">&quot;:&quot;</span></span><br><span class="line">          <span class="bullet">-</span> <span class="bullet">-</span> <span class="string">arn:aws:lambda</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">Ref:</span> <span class="string">AWS::Region</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">Ref:</span> <span class="string">AWS::AccountId</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">function:*</span></span><br></pre></td></tr></table></figure>

<p>如果你的目錄結構跟我一樣，或是跟到今天的實作，加入以下的 code，這邊主要是告訴你的 Lambda 要在每次的 warm-up 字串來的時候呼叫這個 decorator 來幫忙處理一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lib.decorator <span class="keyword">import</span> lambda_warm_up</span><br><span class="line"></span><br><span class="line"><span class="meta">@lambda_warm_up</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xxx</span>():</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>我的 Lambda 都加了，那原本的 flask 建立的 api 我要加在哪？</p>
<p>看看這個<a target="_blank" rel="noopener" href="https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87">網址</a>，serverless-wsgi 在實作的時候已經有考慮到這件事了，所以 api 這邊就不用管他，他自己會去把它處理掉！<br><img src="https://i.imgur.com/skMkdmg.png"></p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>Warm-up 的機制就是透過建立一個 Lambda 來打一個 flag 到其他 Lambda 來他們別進入睡眠模式，但總是會有人考慮費用的問題，可以參考下圖，若是你建立了一個簡單的服務然後上線了，AWS 給你了一百萬個請求的量，我覺得一個月的請求可以到 100 萬應該是服務有點規模的情況，一個月能到這個量相信你也有一定的能力養它 🤣，爾後每一百萬個請求才六塊台幣，可能比 GCP 還貴，但其實以我來說這樣已經很夠用，而且還扛得住<br><img src="https://i.imgur.com/LCJh98n.png"></p>
<h2 id="參考"><a href="#參考" class="headerlink" title="參考"></a>參考</h2><p><a target="_blank" rel="noopener" href="https://github.com/logandk/serverless-wsgi/blob/3a2d1312370a4f4351be60f5fbe838124db1916a/serverless_wsgi.py#L87">serverless-wsgi Warm-up code</a><br><a target="_blank" rel="noopener" href="https://www.npmjs.com/package/serverless-plugin-warmup">Serverless-plugin-warmup</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-tw">
    <link itemprop="mainEntityOfPage" href="https://nijialin.com/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="NiJia Lin">
      <meta itemprop="description" content="You are what you do.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="忍者工坊">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/08/Day24-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8-LINE-LIFF-API/" class="post-title-link" itemprop="url">Day24 - 簡單使用 LINE LIFF API</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">發表於</span>

              <time title="創建時間：2019-10-08 13:02:58" itemprop="dateCreated datePublished" datetime="2019-10-08T13:02:58+00:00">2019-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新於</span>
                <time title="修改時間：2023-03-22 06:17:50" itemprop="dateModified" datetime="2023-03-22T06:17:50+00:00">2023-03-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分類於</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/2019%E9%90%B5%E4%BA%BA%E8%B3%BD/" itemprop="url" rel="index"><span itemprop="name">2019鐵人賽</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以下就為大家帶來簡單的實作以及如何去使用它。</p>
<h2 id="實作"><a href="#實作" class="headerlink" title="實作"></a>實作</h2><p>在<code>views/</code>下新增一個<code>liff_test.html</code>並加入以下內容</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    &lt;meta</span><br><span class="line">      name=&quot;viewport&quot;</span><br><span class="line">      content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://d.line-scdn.net/liff/1.0/sdk.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">initializeApp</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">&quot;#userid&quot;</span>).val(data.context.userId);</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">      $(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        liff.init(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line">          initializeApp(data);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">        $(<span class="string">&quot;#ButtonGetProfile&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">          liff.getProfile().then(<span class="function"><span class="params">profile</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            $(<span class="string">&quot;#UserInfo&quot;</span>).val(profile.displayName);</span></span><br><span class="line"><span class="javascript">            alert(<span class="string">&quot;done&quot;</span>);</span></span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">        $(<span class="string">&quot;#ButtonSendMsg&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">          liff</span><br><span class="line">            .sendMessages([</span><br><span class="line">              &#123;</span><br><span class="line"><span class="javascript">                type: <span class="string">&quot;text&quot;</span>,</span></span><br><span class="line"><span class="javascript">                text: $(<span class="string">&quot;#msg&quot;</span>).val()</span></span><br><span class="line">              &#125;</span><br><span class="line">            ])</span><br><span class="line"><span class="javascript">            .then(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">              alert(<span class="string">&quot;done&quot;</span>);</span></span><br><span class="line"><span class="javascript">              liff.closeWindow(); <span class="comment">// 關掉頁面</span></span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;liff_btn&quot;</span>&gt;</span>Get user profile<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>user id:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;userid&quot;</span> /&gt;</span> <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ButtonGetProfile&quot;</span>&gt;</span>Get Profile<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;UserInfo&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>要傳送的訊息:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;msg&quot;</span> <span class="attr">value</span>=<span class="string">&quot;測試&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ButtonSendMsg&quot;</span>&gt;</span>要傳送的訊息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>以上參考來自<a target="_blank" rel="noopener" href="http://studyhost.blogspot.com/2018/06/linebot23-line-liff-app.html">董老師的部落格</a></p>
</blockquote>
<blockquote>
<p>詳細的 LIFF API 文件可以<a target="_blank" rel="noopener" href="https://developers.line.biz/en/reference/liff/">參考</a></p>
</blockquote>
<p>接下來按著之前做過的一樣把這個檔案送到<code>S3</code>裡，接著它的網址複製起來<br><img src="https://i.imgur.com/wgVJ9js.png"></p>
<p>接著來去之前建立機器人的開發者頁面裡按下最右邊的<code>LIFF</code><br><img src="https://i.imgur.com/B593Hdt.png"><br>按下去之後呢，再來按下<code>add</code><br><img src="https://i.imgur.com/5dNr9G7.png"><br>跑出這個頁面後，<code>Name</code>好辨認為主、<code>Size</code>選擇滿版(Full)、<code>Endpoint URL</code>就把剛剛複製起來的 S3 網址放進去後按<code>Confirm</code><br><img src="https://i.imgur.com/NQD9Mwv.png"><br>大概內容會長得像這樣<br><img src="https://i.imgur.com/WoTYxpv.png"><br>建立成功後往下滑會看到 LINE 給你一個屬於他們的網址，接著可以把它貼到你的機器人上(或者任何聊天室)<br><img src="https://i.imgur.com/wN69WDJ.png"><br>點下去之後就會看到來自 LIFF 的 Webview 囉！<br><img src="https://i.imgur.com/aYztzUi.jpg"><br>接下來就可以開始玩裡面的功能了 🤣</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><p>LIFF 整合的功能讓開發者在 Bot 裡不好實現的功能透過 Webview 的方式讓使用者可以到頁面上做邏輯處理，透過兩種的結合讓整體的應用就有更多的變化，這邊若要給使用者個話就把 <code>line://xxxoxx</code> 製作成 flex message 或者乾脆傳給使用者，引導他點選，如此就能讓使用者到自己設計的頁面上了。</p>
<p>這邊額外補充一點，有看到程式碼裡面可以拉到<code>Query string</code>嗎？事實上可以透過<code>Query string</code>讓使用者帶些參數來做更多的判斷，像是卡米哥做的<a target="_blank" rel="noopener" href="https://github.com/etrex/kamiliff">Kamiliff</a>就是讓使用者在點選後判斷這個 LIFF 的 Size，在導去對應的路由去做處理，這樣子使用者在建立 LIFF 的時候就不用一個頁面弄一個，否則這樣在 dev 轉 prod 的時候應該會弄到很生氣 🤣。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/19/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><span class="page-number current">20</span><a class="page-number" href="/page/21/">21</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/21/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="NiJia Lin"
      src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">NiJia Lin</p>
  <div class="site-description" itemprop="description">You are what you do.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">224</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">298</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/louis70109" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;louis70109" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:louis70109@gmail.com" title="E-Mail → mailto:louis70109@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/linnijia/" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;linnijia&#x2F;" rel="noopener" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">NiJia Lin</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="//cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script>
<script src="//cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script>
<script src="/js/algolia-search.js"></script>














  

  

</body>
</html>
